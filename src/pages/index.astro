---
import Main from '../layouts/Main.astro';
import type { MarkdownInstance } from 'astro';

// TODO: Figure out how to parse this into the structure below, and/or put more info in
const projects = await Astro.glob("../pages/projects/**/*.md");

function makeProjectFromMarkdown(project: MarkdownInstance<Record<string, any>>) {
    return {
        name: project.frontmatter.title as string,
        description: project.frontmatter.description as string,
        tier: parseInt(project.frontmatter.tier),
        image: {
            url: project.frontmatter.image.url as string,
            alt: project.frontmatter.image.alt as string,
        },
        link: project.frontmatter.link as string,
        github: project.frontmatter.github as string,
        tags: project.frontmatter.tags as string[],
        internalUrl: project.url as string,
    };
}

const parsedProjects = projects.map(makeProjectFromMarkdown);
---

<Main
    title="Urban Analytics Technology Platform"
    projects={parsedProjects}
>
